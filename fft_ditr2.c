#include "fft_ditr2.h"							//we use douglas jones' fft dit routine

//hardware configuration
//end hardware configuration

//global defines

//global variables
//use the following if lut_twd is to be calculated using lut_cal()
#ifndef USE_FFT_TWD_LUT
double lut_twd[FFT_N];							//cos..sin look-up table: even point/cos, odd point/sin
#else
//precalculated lut_twd array
//format: cosine, sine
//0..M_PI
#if 	FFT_LOG2N == 4					//16-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.92387953,  -0.38268343,
    0.70710678,  -0.70710678,
    0.38268343,  -0.92387953,
    0.00000000,  -1.00000000,
    -0.38268343,  -0.92387953,
    -0.70710678,  -0.70710678,
    -0.92387953,  -0.38268343,
};
#elif 	FFT_LOG2N == 5					//32-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.98078528,  -0.19509032,
    0.92387953,  -0.38268343,
    0.83146961,  -0.55557023,
    0.70710678,  -0.70710678,
    0.55557023,  -0.83146961,
    0.38268343,  -0.92387953,
    0.19509032,  -0.98078528,
    0.00000000,  -1.00000000,
    -0.19509032,  -0.98078528,
    -0.38268343,  -0.92387953,
    -0.55557023,  -0.83146961,
    -0.70710678,  -0.70710678,
    -0.83146961,  -0.55557023,
    -0.92387953,  -0.38268343,
    -0.98078528,  -0.19509032,
};
#elif 	FFT_LOG2N == 6					//64-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.99518473,  -0.09801714,
    0.98078528,  -0.19509032,
    0.95694034,  -0.29028468,
    0.92387953,  -0.38268343,
    0.88192126,  -0.47139674,
    0.83146961,  -0.55557023,
    0.77301045,  -0.63439328,
    0.70710678,  -0.70710678,
    0.63439328,  -0.77301045,
    0.55557023,  -0.83146961,
    0.47139674,  -0.88192126,
    0.38268343,  -0.92387953,
    0.29028468,  -0.95694034,
    0.19509032,  -0.98078528,
    0.09801714,  -0.99518473,
    0.00000000,  -1.00000000,
    -0.09801714,  -0.99518473,
    -0.19509032,  -0.98078528,
    -0.29028468,  -0.95694034,
    -0.38268343,  -0.92387953,
    -0.47139674,  -0.88192126,
    -0.55557023,  -0.83146961,
    -0.63439328,  -0.77301045,
    -0.70710678,  -0.70710678,
    -0.77301045,  -0.63439328,
    -0.83146961,  -0.55557023,
    -0.88192126,  -0.47139674,
    -0.92387953,  -0.38268343,
    -0.95694034,  -0.29028468,
    -0.98078528,  -0.19509032,
    -0.99518473,  -0.09801714,
};
#elif 	FFT_LOG2N == 7					//128-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.99879546,  -0.04906767,
    0.99518473,  -0.09801714,
    0.98917651,  -0.14673047,
    0.98078528,  -0.19509032,
    0.97003125,  -0.24298018,
    0.95694034,  -0.29028468,
    0.94154407,  -0.33688985,
    0.92387953,  -0.38268343,
    0.90398929,  -0.42755509,
    0.88192126,  -0.47139674,
    0.85772861,  -0.51410274,
    0.83146961,  -0.55557023,
    0.80320753,  -0.59569930,
    0.77301045,  -0.63439328,
    0.74095113,  -0.67155895,
    0.70710678,  -0.70710678,
    0.67155895,  -0.74095113,
    0.63439328,  -0.77301045,
    0.59569930,  -0.80320753,
    0.55557023,  -0.83146961,
    0.51410274,  -0.85772861,
    0.47139674,  -0.88192126,
    0.42755509,  -0.90398929,
    0.38268343,  -0.92387953,
    0.33688985,  -0.94154407,
    0.29028468,  -0.95694034,
    0.24298018,  -0.97003125,
    0.19509032,  -0.98078528,
    0.14673047,  -0.98917651,
    0.09801714,  -0.99518473,
    0.04906767,  -0.99879546,
    0.00000000,  -1.00000000,
    -0.04906767,  -0.99879546,
    -0.09801714,  -0.99518473,
    -0.14673047,  -0.98917651,
    -0.19509032,  -0.98078528,
    -0.24298018,  -0.97003125,
    -0.29028468,  -0.95694034,
    -0.33688985,  -0.94154407,
    -0.38268343,  -0.92387953,
    -0.42755509,  -0.90398929,
    -0.47139674,  -0.88192126,
    -0.51410274,  -0.85772861,
    -0.55557023,  -0.83146961,
    -0.59569930,  -0.80320753,
    -0.63439328,  -0.77301045,
    -0.67155895,  -0.74095113,
    -0.70710678,  -0.70710678,
    -0.74095113,  -0.67155895,
    -0.77301045,  -0.63439328,
    -0.80320753,  -0.59569930,
    -0.83146961,  -0.55557023,
    -0.85772861,  -0.51410274,
    -0.88192126,  -0.47139674,
    -0.90398929,  -0.42755509,
    -0.92387953,  -0.38268343,
    -0.94154407,  -0.33688985,
    -0.95694034,  -0.29028468,
    -0.97003125,  -0.24298018,
    -0.98078528,  -0.19509032,
    -0.98917651,  -0.14673047,
    -0.99518473,  -0.09801714,
    -0.99879546,  -0.04906767,
};
#elif 	FFT_LOG2N == 8					//256-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.99969882,  -0.02454123,
    0.99879546,  -0.04906767,
    0.99729046,  -0.07356456,
    0.99518473,  -0.09801714,
    0.99247953,  -0.12241068,
    0.98917651,  -0.14673047,
    0.98527764,  -0.17096189,
    0.98078528,  -0.19509032,
    0.97570213,  -0.21910124,
    0.97003125,  -0.24298018,
    0.96377607,  -0.26671276,
    0.95694034,  -0.29028468,
    0.94952818,  -0.31368174,
    0.94154407,  -0.33688985,
    0.93299280,  -0.35989504,
    0.92387953,  -0.38268343,
    0.91420976,  -0.40524131,
    0.90398929,  -0.42755509,
    0.89322430,  -0.44961133,
    0.88192126,  -0.47139674,
    0.87008699,  -0.49289819,
    0.85772861,  -0.51410274,
    0.84485357,  -0.53499762,
    0.83146961,  -0.55557023,
    0.81758481,  -0.57580819,
    0.80320753,  -0.59569930,
    0.78834643,  -0.61523159,
    0.77301045,  -0.63439328,
    0.75720885,  -0.65317284,
    0.74095113,  -0.67155895,
    0.72424708,  -0.68954054,
    0.70710678,  -0.70710678,
    0.68954054,  -0.72424708,
    0.67155895,  -0.74095113,
    0.65317284,  -0.75720885,
    0.63439328,  -0.77301045,
    0.61523159,  -0.78834643,
    0.59569930,  -0.80320753,
    0.57580819,  -0.81758481,
    0.55557023,  -0.83146961,
    0.53499762,  -0.84485357,
    0.51410274,  -0.85772861,
    0.49289819,  -0.87008699,
    0.47139674,  -0.88192126,
    0.44961133,  -0.89322430,
    0.42755509,  -0.90398929,
    0.40524131,  -0.91420976,
    0.38268343,  -0.92387953,
    0.35989504,  -0.93299280,
    0.33688985,  -0.94154407,
    0.31368174,  -0.94952818,
    0.29028468,  -0.95694034,
    0.26671276,  -0.96377607,
    0.24298018,  -0.97003125,
    0.21910124,  -0.97570213,
    0.19509032,  -0.98078528,
    0.17096189,  -0.98527764,
    0.14673047,  -0.98917651,
    0.12241068,  -0.99247953,
    0.09801714,  -0.99518473,
    0.07356456,  -0.99729046,
    0.04906767,  -0.99879546,
    0.02454123,  -0.99969882,
    0.00000000,  -1.00000000,
    -0.02454123,  -0.99969882,
    -0.04906767,  -0.99879546,
    -0.07356456,  -0.99729046,
    -0.09801714,  -0.99518473,
    -0.12241068,  -0.99247953,
    -0.14673047,  -0.98917651,
    -0.17096189,  -0.98527764,
    -0.19509032,  -0.98078528,
    -0.21910124,  -0.97570213,
    -0.24298018,  -0.97003125,
    -0.26671276,  -0.96377607,
    -0.29028468,  -0.95694034,
    -0.31368174,  -0.94952818,
    -0.33688985,  -0.94154407,
    -0.35989504,  -0.93299280,
    -0.38268343,  -0.92387953,
    -0.40524131,  -0.91420976,
    -0.42755509,  -0.90398929,
    -0.44961133,  -0.89322430,
    -0.47139674,  -0.88192126,
    -0.49289819,  -0.87008699,
    -0.51410274,  -0.85772861,
    -0.53499762,  -0.84485357,
    -0.55557023,  -0.83146961,
    -0.57580819,  -0.81758481,
    -0.59569930,  -0.80320753,
    -0.61523159,  -0.78834643,
    -0.63439328,  -0.77301045,
    -0.65317284,  -0.75720885,
    -0.67155895,  -0.74095113,
    -0.68954054,  -0.72424708,
    -0.70710678,  -0.70710678,
    -0.72424708,  -0.68954054,
    -0.74095113,  -0.67155895,
    -0.75720885,  -0.65317284,
    -0.77301045,  -0.63439328,
    -0.78834643,  -0.61523159,
    -0.80320753,  -0.59569930,
    -0.81758481,  -0.57580819,
    -0.83146961,  -0.55557023,
    -0.84485357,  -0.53499762,
    -0.85772861,  -0.51410274,
    -0.87008699,  -0.49289819,
    -0.88192126,  -0.47139674,
    -0.89322430,  -0.44961133,
    -0.90398929,  -0.42755509,
    -0.91420976,  -0.40524131,
    -0.92387953,  -0.38268343,
    -0.93299280,  -0.35989504,
    -0.94154407,  -0.33688985,
    -0.94952818,  -0.31368174,
    -0.95694034,  -0.29028468,
    -0.96377607,  -0.26671276,
    -0.97003125,  -0.24298018,
    -0.97570213,  -0.21910124,
    -0.98078528,  -0.19509032,
    -0.98527764,  -0.17096189,
    -0.98917651,  -0.14673047,
    -0.99247953,  -0.12241068,
    -0.99518473,  -0.09801714,
    -0.99729046,  -0.07356456,
    -0.99879546,  -0.04906767,
    -0.99969882,  -0.02454123,
};
#elif 	FFT_LOG2N == 9					//512-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.99992470,  -0.01227154,
    0.99969882,  -0.02454123,
    0.99932238,  -0.03680722,
    0.99879546,  -0.04906767,
    0.99811811,  -0.06132074,
    0.99729046,  -0.07356456,
    0.99631261,  -0.08579731,
    0.99518473,  -0.09801714,
    0.99390697,  -0.11022221,
    0.99247953,  -0.12241068,
    0.99090264,  -0.13458071,
    0.98917651,  -0.14673047,
    0.98730142,  -0.15885814,
    0.98527764,  -0.17096189,
    0.98310549,  -0.18303989,
    0.98078528,  -0.19509032,
    0.97831737,  -0.20711138,
    0.97570213,  -0.21910124,
    0.97293995,  -0.23105811,
    0.97003125,  -0.24298018,
    0.96697647,  -0.25486566,
    0.96377607,  -0.26671276,
    0.96043052,  -0.27851969,
    0.95694034,  -0.29028468,
    0.95330604,  -0.30200595,
    0.94952818,  -0.31368174,
    0.94560733,  -0.32531029,
    0.94154407,  -0.33688985,
    0.93733901,  -0.34841868,
    0.93299280,  -0.35989504,
    0.92850608,  -0.37131719,
    0.92387953,  -0.38268343,
    0.91911385,  -0.39399204,
    0.91420976,  -0.40524131,
    0.90916798,  -0.41642956,
    0.90398929,  -0.42755509,
    0.89867447,  -0.43861624,
    0.89322430,  -0.44961133,
    0.88763962,  -0.46053871,
    0.88192126,  -0.47139674,
    0.87607009,  -0.48218377,
    0.87008699,  -0.49289819,
    0.86397286,  -0.50353838,
    0.85772861,  -0.51410274,
    0.85135519,  -0.52458968,
    0.84485357,  -0.53499762,
    0.83822471,  -0.54532499,
    0.83146961,  -0.55557023,
    0.82458930,  -0.56573181,
    0.81758481,  -0.57580819,
    0.81045720,  -0.58579786,
    0.80320753,  -0.59569930,
    0.79583690,  -0.60551104,
    0.78834643,  -0.61523159,
    0.78073723,  -0.62485949,
    0.77301045,  -0.63439328,
    0.76516727,  -0.64383154,
    0.75720885,  -0.65317284,
    0.74913639,  -0.66241578,
    0.74095113,  -0.67155895,
    0.73265427,  -0.68060100,
    0.72424708,  -0.68954054,
    0.71573083,  -0.69837625,
    0.70710678,  -0.70710678,
    0.69837625,  -0.71573083,
    0.68954054,  -0.72424708,
    0.68060100,  -0.73265427,
    0.67155895,  -0.74095113,
    0.66241578,  -0.74913639,
    0.65317284,  -0.75720885,
    0.64383154,  -0.76516727,
    0.63439328,  -0.77301045,
    0.62485949,  -0.78073723,
    0.61523159,  -0.78834643,
    0.60551104,  -0.79583690,
    0.59569930,  -0.80320753,
    0.58579786,  -0.81045720,
    0.57580819,  -0.81758481,
    0.56573181,  -0.82458930,
    0.55557023,  -0.83146961,
    0.54532499,  -0.83822471,
    0.53499762,  -0.84485357,
    0.52458968,  -0.85135519,
    0.51410274,  -0.85772861,
    0.50353838,  -0.86397286,
    0.49289819,  -0.87008699,
    0.48218377,  -0.87607009,
    0.47139674,  -0.88192126,
    0.46053871,  -0.88763962,
    0.44961133,  -0.89322430,
    0.43861624,  -0.89867447,
    0.42755509,  -0.90398929,
    0.41642956,  -0.90916798,
    0.40524131,  -0.91420976,
    0.39399204,  -0.91911385,
    0.38268343,  -0.92387953,
    0.37131719,  -0.92850608,
    0.35989504,  -0.93299280,
    0.34841868,  -0.93733901,
    0.33688985,  -0.94154407,
    0.32531029,  -0.94560733,
    0.31368174,  -0.94952818,
    0.30200595,  -0.95330604,
    0.29028468,  -0.95694034,
    0.27851969,  -0.96043052,
    0.26671276,  -0.96377607,
    0.25486566,  -0.96697647,
    0.24298018,  -0.97003125,
    0.23105811,  -0.97293995,
    0.21910124,  -0.97570213,
    0.20711138,  -0.97831737,
    0.19509032,  -0.98078528,
    0.18303989,  -0.98310549,
    0.17096189,  -0.98527764,
    0.15885814,  -0.98730142,
    0.14673047,  -0.98917651,
    0.13458071,  -0.99090264,
    0.12241068,  -0.99247953,
    0.11022221,  -0.99390697,
    0.09801714,  -0.99518473,
    0.08579731,  -0.99631261,
    0.07356456,  -0.99729046,
    0.06132074,  -0.99811811,
    0.04906767,  -0.99879546,
    0.03680722,  -0.99932238,
    0.02454123,  -0.99969882,
    0.01227154,  -0.99992470,
    0.00000000,  -1.00000000,
    -0.01227154,  -0.99992470,
    -0.02454123,  -0.99969882,
    -0.03680722,  -0.99932238,
    -0.04906767,  -0.99879546,
    -0.06132074,  -0.99811811,
    -0.07356456,  -0.99729046,
    -0.08579731,  -0.99631261,
    -0.09801714,  -0.99518473,
    -0.11022221,  -0.99390697,
    -0.12241068,  -0.99247953,
    -0.13458071,  -0.99090264,
    -0.14673047,  -0.98917651,
    -0.15885814,  -0.98730142,
    -0.17096189,  -0.98527764,
    -0.18303989,  -0.98310549,
    -0.19509032,  -0.98078528,
    -0.20711138,  -0.97831737,
    -0.21910124,  -0.97570213,
    -0.23105811,  -0.97293995,
    -0.24298018,  -0.97003125,
    -0.25486566,  -0.96697647,
    -0.26671276,  -0.96377607,
    -0.27851969,  -0.96043052,
    -0.29028468,  -0.95694034,
    -0.30200595,  -0.95330604,
    -0.31368174,  -0.94952818,
    -0.32531029,  -0.94560733,
    -0.33688985,  -0.94154407,
    -0.34841868,  -0.93733901,
    -0.35989504,  -0.93299280,
    -0.37131719,  -0.92850608,
    -0.38268343,  -0.92387953,
    -0.39399204,  -0.91911385,
    -0.40524131,  -0.91420976,
    -0.41642956,  -0.90916798,
    -0.42755509,  -0.90398929,
    -0.43861624,  -0.89867447,
    -0.44961133,  -0.89322430,
    -0.46053871,  -0.88763962,
    -0.47139674,  -0.88192126,
    -0.48218377,  -0.87607009,
    -0.49289819,  -0.87008699,
    -0.50353838,  -0.86397286,
    -0.51410274,  -0.85772861,
    -0.52458968,  -0.85135519,
    -0.53499762,  -0.84485357,
    -0.54532499,  -0.83822471,
    -0.55557023,  -0.83146961,
    -0.56573181,  -0.82458930,
    -0.57580819,  -0.81758481,
    -0.58579786,  -0.81045720,
    -0.59569930,  -0.80320753,
    -0.60551104,  -0.79583690,
    -0.61523159,  -0.78834643,
    -0.62485949,  -0.78073723,
    -0.63439328,  -0.77301045,
    -0.64383154,  -0.76516727,
    -0.65317284,  -0.75720885,
    -0.66241578,  -0.74913639,
    -0.67155895,  -0.74095113,
    -0.68060100,  -0.73265427,
    -0.68954054,  -0.72424708,
    -0.69837625,  -0.71573083,
    -0.70710678,  -0.70710678,
    -0.71573083,  -0.69837625,
    -0.72424708,  -0.68954054,
    -0.73265427,  -0.68060100,
    -0.74095113,  -0.67155895,
    -0.74913639,  -0.66241578,
    -0.75720885,  -0.65317284,
    -0.76516727,  -0.64383154,
    -0.77301045,  -0.63439328,
    -0.78073723,  -0.62485949,
    -0.78834643,  -0.61523159,
    -0.79583690,  -0.60551104,
    -0.80320753,  -0.59569930,
    -0.81045720,  -0.58579786,
    -0.81758481,  -0.57580819,
    -0.82458930,  -0.56573181,
    -0.83146961,  -0.55557023,
    -0.83822471,  -0.54532499,
    -0.84485357,  -0.53499762,
    -0.85135519,  -0.52458968,
    -0.85772861,  -0.51410274,
    -0.86397286,  -0.50353838,
    -0.87008699,  -0.49289819,
    -0.87607009,  -0.48218377,
    -0.88192126,  -0.47139674,
    -0.88763962,  -0.46053871,
    -0.89322430,  -0.44961133,
    -0.89867447,  -0.43861624,
    -0.90398929,  -0.42755509,
    -0.90916798,  -0.41642956,
    -0.91420976,  -0.40524131,
    -0.91911385,  -0.39399204,
    -0.92387953,  -0.38268343,
    -0.92850608,  -0.37131719,
    -0.93299280,  -0.35989504,
    -0.93733901,  -0.34841868,
    -0.94154407,  -0.33688985,
    -0.94560733,  -0.32531029,
    -0.94952818,  -0.31368174,
    -0.95330604,  -0.30200595,
    -0.95694034,  -0.29028468,
    -0.96043052,  -0.27851969,
    -0.96377607,  -0.26671276,
    -0.96697647,  -0.25486566,
    -0.97003125,  -0.24298018,
    -0.97293995,  -0.23105811,
    -0.97570213,  -0.21910124,
    -0.97831737,  -0.20711138,
    -0.98078528,  -0.19509032,
    -0.98310549,  -0.18303989,
    -0.98527764,  -0.17096189,
    -0.98730142,  -0.15885814,
    -0.98917651,  -0.14673047,
    -0.99090264,  -0.13458071,
    -0.99247953,  -0.12241068,
    -0.99390697,  -0.11022221,
    -0.99518473,  -0.09801714,
    -0.99631261,  -0.08579731,
    -0.99729046,  -0.07356456,
    -0.99811811,  -0.06132074,
    -0.99879546,  -0.04906767,
    -0.99932238,  -0.03680722,
    -0.99969882,  -0.02454123,
    -0.99992470,  -0.01227154,
};
#elif 	FFT_LOG2N == 10					//1024-point FFT
const double lut_twd[]= {
    1.00000000,  -0.00000000,
    0.99998118,  -0.00613588,
    0.99992470,  -0.01227154,
    0.99983058,  -0.01840673,
    0.99969882,  -0.02454123,
    0.99952942,  -0.03067480,
    0.99932238,  -0.03680722,
    0.99907773,  -0.04293826,
    0.99879546,  -0.04906767,
    0.99847558,  -0.05519524,
    0.99811811,  -0.06132074,
    0.99772307,  -0.06744392,
    0.99729046,  -0.07356456,
    0.99682030,  -0.07968244,
    0.99631261,  -0.08579731,
    0.99576741,  -0.09190896,
    0.99518473,  -0.09801714,
    0.99456457,  -0.10412163,
    0.99390697,  -0.11022221,
    0.99321195,  -0.11631863,
    0.99247953,  -0.12241068,
    0.99170975,  -0.12849811,
    0.99090264,  -0.13458071,
    0.99005821,  -0.14065824,
    0.98917651,  -0.14673047,
    0.98825757,  -0.15279719,
    0.98730142,  -0.15885814,
    0.98630810,  -0.16491312,
    0.98527764,  -0.17096189,
    0.98421009,  -0.17700422,
    0.98310549,  -0.18303989,
    0.98196387,  -0.18906866,
    0.98078528,  -0.19509032,
    0.97956977,  -0.20110463,
    0.97831737,  -0.20711138,
    0.97702814,  -0.21311032,
    0.97570213,  -0.21910124,
    0.97433938,  -0.22508391,
    0.97293995,  -0.23105811,
    0.97150389,  -0.23702361,
    0.97003125,  -0.24298018,
    0.96852209,  -0.24892761,
    0.96697647,  -0.25486566,
    0.96539444,  -0.26079412,
    0.96377607,  -0.26671276,
    0.96212140,  -0.27262136,
    0.96043052,  -0.27851969,
    0.95870347,  -0.28440754,
    0.95694034,  -0.29028468,
    0.95514117,  -0.29615089,
    0.95330604,  -0.30200595,
    0.95143502,  -0.30784964,
    0.94952818,  -0.31368174,
    0.94758559,  -0.31950203,
    0.94560733,  -0.32531029,
    0.94359346,  -0.33110631,
    0.94154407,  -0.33688985,
    0.93945922,  -0.34266072,
    0.93733901,  -0.34841868,
    0.93518351,  -0.35416353,
    0.93299280,  -0.35989504,
    0.93076696,  -0.36561300,
    0.92850608,  -0.37131719,
    0.92621024,  -0.37700741,
    0.92387953,  -0.38268343,
    0.92151404,  -0.38834505,
    0.91911385,  -0.39399204,
    0.91667906,  -0.39962420,
    0.91420976,  -0.40524131,
    0.91170603,  -0.41084317,
    0.90916798,  -0.41642956,
    0.90659570,  -0.42200027,
    0.90398929,  -0.42755509,
    0.90134885,  -0.43309382,
    0.89867447,  -0.43861624,
    0.89596625,  -0.44412214,
    0.89322430,  -0.44961133,
    0.89044872,  -0.45508359,
    0.88763962,  -0.46053871,
    0.88479710,  -0.46597650,
    0.88192126,  -0.47139674,
    0.87901223,  -0.47679923,
    0.87607009,  -0.48218377,
    0.87309498,  -0.48755016,
    0.87008699,  -0.49289819,
    0.86704625,  -0.49822767,
    0.86397286,  -0.50353838,
    0.86086694,  -0.50883014,
    0.85772861,  -0.51410274,
    0.85455799,  -0.51935599,
    0.85135519,  -0.52458968,
    0.84812034,  -0.52980362,
    0.84485357,  -0.53499762,
    0.84155498,  -0.54017147,
    0.83822471,  -0.54532499,
    0.83486287,  -0.55045797,
    0.83146961,  -0.55557023,
    0.82804505,  -0.56066158,
    0.82458930,  -0.56573181,
    0.82110251,  -0.57078075,
    0.81758481,  -0.57580819,
    0.81403633,  -0.58081396,
    0.81045720,  -0.58579786,
    0.80684755,  -0.59075970,
    0.80320753,  -0.59569930,
    0.79953727,  -0.60061648,
    0.79583690,  -0.60551104,
    0.79210658,  -0.61038281,
    0.78834643,  -0.61523159,
    0.78455660,  -0.62005721,
    0.78073723,  -0.62485949,
    0.77688847,  -0.62963824,
    0.77301045,  -0.63439328,
    0.76910334,  -0.63912444,
    0.76516727,  -0.64383154,
    0.76120239,  -0.64851440,
    0.75720885,  -0.65317284,
    0.75318680,  -0.65780669,
    0.74913639,  -0.66241578,
    0.74505779,  -0.66699992,
    0.74095113,  -0.67155895,
    0.73681657,  -0.67609270,
    0.73265427,  -0.68060100,
    0.72846439,  -0.68508367,
    0.72424708,  -0.68954054,
    0.72000251,  -0.69397146,
    0.71573083,  -0.69837625,
    0.71143220,  -0.70275474,
    0.70710678,  -0.70710678,
    0.70275474,  -0.71143220,
    0.69837625,  -0.71573083,
    0.69397146,  -0.72000251,
    0.68954054,  -0.72424708,
    0.68508367,  -0.72846439,
    0.68060100,  -0.73265427,
    0.67609270,  -0.73681657,
    0.67155895,  -0.74095113,
    0.66699992,  -0.74505779,
    0.66241578,  -0.74913639,
    0.65780669,  -0.75318680,
    0.65317284,  -0.75720885,
    0.64851440,  -0.76120239,
    0.64383154,  -0.76516727,
    0.63912444,  -0.76910334,
    0.63439328,  -0.77301045,
    0.62963824,  -0.77688847,
    0.62485949,  -0.78073723,
    0.62005721,  -0.78455660,
    0.61523159,  -0.78834643,
    0.61038281,  -0.79210658,
    0.60551104,  -0.79583690,
    0.60061648,  -0.79953727,
    0.59569930,  -0.80320753,
    0.59075970,  -0.80684755,
    0.58579786,  -0.81045720,
    0.58081396,  -0.81403633,
    0.57580819,  -0.81758481,
    0.57078075,  -0.82110251,
    0.56573181,  -0.82458930,
    0.56066158,  -0.82804505,
    0.55557023,  -0.83146961,
    0.55045797,  -0.83486287,
    0.54532499,  -0.83822471,
    0.54017147,  -0.84155498,
    0.53499762,  -0.84485357,
    0.52980362,  -0.84812034,
    0.52458968,  -0.85135519,
    0.51935599,  -0.85455799,
    0.51410274,  -0.85772861,
    0.50883014,  -0.86086694,
    0.50353838,  -0.86397286,
    0.49822767,  -0.86704625,
    0.49289819,  -0.87008699,
    0.48755016,  -0.87309498,
    0.48218377,  -0.87607009,
    0.47679923,  -0.87901223,
    0.47139674,  -0.88192126,
    0.46597650,  -0.88479710,
    0.46053871,  -0.88763962,
    0.45508359,  -0.89044872,
    0.44961133,  -0.89322430,
    0.44412214,  -0.89596625,
    0.43861624,  -0.89867447,
    0.43309382,  -0.90134885,
    0.42755509,  -0.90398929,
    0.42200027,  -0.90659570,
    0.41642956,  -0.90916798,
    0.41084317,  -0.91170603,
    0.40524131,  -0.91420976,
    0.39962420,  -0.91667906,
    0.39399204,  -0.91911385,
    0.38834505,  -0.92151404,
    0.38268343,  -0.92387953,
    0.37700741,  -0.92621024,
    0.37131719,  -0.92850608,
    0.36561300,  -0.93076696,
    0.35989504,  -0.93299280,
    0.35416353,  -0.93518351,
    0.34841868,  -0.93733901,
    0.34266072,  -0.93945922,
    0.33688985,  -0.94154407,
    0.33110631,  -0.94359346,
    0.32531029,  -0.94560733,
    0.31950203,  -0.94758559,
    0.31368174,  -0.94952818,
    0.30784964,  -0.95143502,
    0.30200595,  -0.95330604,
    0.29615089,  -0.95514117,
    0.29028468,  -0.95694034,
    0.28440754,  -0.95870347,
    0.27851969,  -0.96043052,
    0.27262136,  -0.96212140,
    0.26671276,  -0.96377607,
    0.26079412,  -0.96539444,
    0.25486566,  -0.96697647,
    0.24892761,  -0.96852209,
    0.24298018,  -0.97003125,
    0.23702361,  -0.97150389,
    0.23105811,  -0.97293995,
    0.22508391,  -0.97433938,
    0.21910124,  -0.97570213,
    0.21311032,  -0.97702814,
    0.20711138,  -0.97831737,
    0.20110463,  -0.97956977,
    0.19509032,  -0.98078528,
    0.18906866,  -0.98196387,
    0.18303989,  -0.98310549,
    0.17700422,  -0.98421009,
    0.17096189,  -0.98527764,
    0.16491312,  -0.98630810,
    0.15885814,  -0.98730142,
    0.15279719,  -0.98825757,
    0.14673047,  -0.98917651,
    0.14065824,  -0.99005821,
    0.13458071,  -0.99090264,
    0.12849811,  -0.99170975,
    0.12241068,  -0.99247953,
    0.11631863,  -0.99321195,
    0.11022221,  -0.99390697,
    0.10412163,  -0.99456457,
    0.09801714,  -0.99518473,
    0.09190896,  -0.99576741,
    0.08579731,  -0.99631261,
    0.07968244,  -0.99682030,
    0.07356456,  -0.99729046,
    0.06744392,  -0.99772307,
    0.06132074,  -0.99811811,
    0.05519524,  -0.99847558,
    0.04906767,  -0.99879546,
    0.04293826,  -0.99907773,
    0.03680722,  -0.99932238,
    0.03067480,  -0.99952942,
    0.02454123,  -0.99969882,
    0.01840673,  -0.99983058,
    0.01227154,  -0.99992470,
    0.00613588,  -0.99998118,
    0.00000000,  -1.00000000,
    -0.00613588,  -0.99998118,
    -0.01227154,  -0.99992470,
    -0.01840673,  -0.99983058,
    -0.02454123,  -0.99969882,
    -0.03067480,  -0.99952942,
    -0.03680722,  -0.99932238,
    -0.04293826,  -0.99907773,
    -0.04906767,  -0.99879546,
    -0.05519524,  -0.99847558,
    -0.06132074,  -0.99811811,
    -0.06744392,  -0.99772307,
    -0.07356456,  -0.99729046,
    -0.07968244,  -0.99682030,
    -0.08579731,  -0.99631261,
    -0.09190896,  -0.99576741,
    -0.09801714,  -0.99518473,
    -0.10412163,  -0.99456457,
    -0.11022221,  -0.99390697,
    -0.11631863,  -0.99321195,
    -0.12241068,  -0.99247953,
    -0.12849811,  -0.99170975,
    -0.13458071,  -0.99090264,
    -0.14065824,  -0.99005821,
    -0.14673047,  -0.98917651,
    -0.15279719,  -0.98825757,
    -0.15885814,  -0.98730142,
    -0.16491312,  -0.98630810,
    -0.17096189,  -0.98527764,
    -0.17700422,  -0.98421009,
    -0.18303989,  -0.98310549,
    -0.18906866,  -0.98196387,
    -0.19509032,  -0.98078528,
    -0.20110463,  -0.97956977,
    -0.20711138,  -0.97831737,
    -0.21311032,  -0.97702814,
    -0.21910124,  -0.97570213,
    -0.22508391,  -0.97433938,
    -0.23105811,  -0.97293995,
    -0.23702361,  -0.97150389,
    -0.24298018,  -0.97003125,
    -0.24892761,  -0.96852209,
    -0.25486566,  -0.96697647,
    -0.26079412,  -0.96539444,
    -0.26671276,  -0.96377607,
    -0.27262136,  -0.96212140,
    -0.27851969,  -0.96043052,
    -0.28440754,  -0.95870347,
    -0.29028468,  -0.95694034,
    -0.29615089,  -0.95514117,
    -0.30200595,  -0.95330604,
    -0.30784964,  -0.95143502,
    -0.31368174,  -0.94952818,
    -0.31950203,  -0.94758559,
    -0.32531029,  -0.94560733,
    -0.33110631,  -0.94359346,
    -0.33688985,  -0.94154407,
    -0.34266072,  -0.93945922,
    -0.34841868,  -0.93733901,
    -0.35416353,  -0.93518351,
    -0.35989504,  -0.93299280,
    -0.36561300,  -0.93076696,
    -0.37131719,  -0.92850608,
    -0.37700741,  -0.92621024,
    -0.38268343,  -0.92387953,
    -0.38834505,  -0.92151404,
    -0.39399204,  -0.91911385,
    -0.39962420,  -0.91667906,
    -0.40524131,  -0.91420976,
    -0.41084317,  -0.91170603,
    -0.41642956,  -0.90916798,
    -0.42200027,  -0.90659570,
    -0.42755509,  -0.90398929,
    -0.43309382,  -0.90134885,
    -0.43861624,  -0.89867447,
    -0.44412214,  -0.89596625,
    -0.44961133,  -0.89322430,
    -0.45508359,  -0.89044872,
    -0.46053871,  -0.88763962,
    -0.46597650,  -0.88479710,
    -0.47139674,  -0.88192126,
    -0.47679923,  -0.87901223,
    -0.48218377,  -0.87607009,
    -0.48755016,  -0.87309498,
    -0.49289819,  -0.87008699,
    -0.49822767,  -0.86704625,
    -0.50353838,  -0.86397286,
    -0.50883014,  -0.86086694,
    -0.51410274,  -0.85772861,
    -0.51935599,  -0.85455799,
    -0.52458968,  -0.85135519,
    -0.52980362,  -0.84812034,
    -0.53499762,  -0.84485357,
    -0.54017147,  -0.84155498,
    -0.54532499,  -0.83822471,
    -0.55045797,  -0.83486287,
    -0.55557023,  -0.83146961,
    -0.56066158,  -0.82804505,
    -0.56573181,  -0.82458930,
    -0.57078075,  -0.82110251,
    -0.57580819,  -0.81758481,
    -0.58081396,  -0.81403633,
    -0.58579786,  -0.81045720,
    -0.59075970,  -0.80684755,
    -0.59569930,  -0.80320753,
    -0.60061648,  -0.79953727,
    -0.60551104,  -0.79583690,
    -0.61038281,  -0.79210658,
    -0.61523159,  -0.78834643,
    -0.62005721,  -0.78455660,
    -0.62485949,  -0.78073723,
    -0.62963824,  -0.77688847,
    -0.63439328,  -0.77301045,
    -0.63912444,  -0.76910334,
    -0.64383154,  -0.76516727,
    -0.64851440,  -0.76120239,
    -0.65317284,  -0.75720885,
    -0.65780669,  -0.75318680,
    -0.66241578,  -0.74913639,
    -0.66699992,  -0.74505779,
    -0.67155895,  -0.74095113,
    -0.67609270,  -0.73681657,
    -0.68060100,  -0.73265427,
    -0.68508367,  -0.72846439,
    -0.68954054,  -0.72424708,
    -0.69397146,  -0.72000251,
    -0.69837625,  -0.71573083,
    -0.70275474,  -0.71143220,
    -0.70710678,  -0.70710678,
    -0.71143220,  -0.70275474,
    -0.71573083,  -0.69837625,
    -0.72000251,  -0.69397146,
    -0.72424708,  -0.68954054,
    -0.72846439,  -0.68508367,
    -0.73265427,  -0.68060100,
    -0.73681657,  -0.67609270,
    -0.74095113,  -0.67155895,
    -0.74505779,  -0.66699992,
    -0.74913639,  -0.66241578,
    -0.75318680,  -0.65780669,
    -0.75720885,  -0.65317284,
    -0.76120239,  -0.64851440,
    -0.76516727,  -0.64383154,
    -0.76910334,  -0.63912444,
    -0.77301045,  -0.63439328,
    -0.77688847,  -0.62963824,
    -0.78073723,  -0.62485949,
    -0.78455660,  -0.62005721,
    -0.78834643,  -0.61523159,
    -0.79210658,  -0.61038281,
    -0.79583690,  -0.60551104,
    -0.79953727,  -0.60061648,
    -0.80320753,  -0.59569930,
    -0.80684755,  -0.59075970,
    -0.81045720,  -0.58579786,
    -0.81403633,  -0.58081396,
    -0.81758481,  -0.57580819,
    -0.82110251,  -0.57078075,
    -0.82458930,  -0.56573181,
    -0.82804505,  -0.56066158,
    -0.83146961,  -0.55557023,
    -0.83486287,  -0.55045797,
    -0.83822471,  -0.54532499,
    -0.84155498,  -0.54017147,
    -0.84485357,  -0.53499762,
    -0.84812034,  -0.52980362,
    -0.85135519,  -0.52458968,
    -0.85455799,  -0.51935599,
    -0.85772861,  -0.51410274,
    -0.86086694,  -0.50883014,
    -0.86397286,  -0.50353838,
    -0.86704625,  -0.49822767,
    -0.87008699,  -0.49289819,
    -0.87309498,  -0.48755016,
    -0.87607009,  -0.48218377,
    -0.87901223,  -0.47679923,
    -0.88192126,  -0.47139674,
    -0.88479710,  -0.46597650,
    -0.88763962,  -0.46053871,
    -0.89044872,  -0.45508359,
    -0.89322430,  -0.44961133,
    -0.89596625,  -0.44412214,
    -0.89867447,  -0.43861624,
    -0.90134885,  -0.43309382,
    -0.90398929,  -0.42755509,
    -0.90659570,  -0.42200027,
    -0.90916798,  -0.41642956,
    -0.91170603,  -0.41084317,
    -0.91420976,  -0.40524131,
    -0.91667906,  -0.39962420,
    -0.91911385,  -0.39399204,
    -0.92151404,  -0.38834505,
    -0.92387953,  -0.38268343,
    -0.92621024,  -0.37700741,
    -0.92850608,  -0.37131719,
    -0.93076696,  -0.36561300,
    -0.93299280,  -0.35989504,
    -0.93518351,  -0.35416353,
    -0.93733901,  -0.34841868,
    -0.93945922,  -0.34266072,
    -0.94154407,  -0.33688985,
    -0.94359346,  -0.33110631,
    -0.94560733,  -0.32531029,
    -0.94758559,  -0.31950203,
    -0.94952818,  -0.31368174,
    -0.95143502,  -0.30784964,
    -0.95330604,  -0.30200595,
    -0.95514117,  -0.29615089,
    -0.95694034,  -0.29028468,
    -0.95870347,  -0.28440754,
    -0.96043052,  -0.27851969,
    -0.96212140,  -0.27262136,
    -0.96377607,  -0.26671276,
    -0.96539444,  -0.26079412,
    -0.96697647,  -0.25486566,
    -0.96852209,  -0.24892761,
    -0.97003125,  -0.24298018,
    -0.97150389,  -0.23702361,
    -0.97293995,  -0.23105811,
    -0.97433938,  -0.22508391,
    -0.97570213,  -0.21910124,
    -0.97702814,  -0.21311032,
    -0.97831737,  -0.20711138,
    -0.97956977,  -0.20110463,
    -0.98078528,  -0.19509032,
    -0.98196387,  -0.18906866,
    -0.98310549,  -0.18303989,
    -0.98421009,  -0.17700422,
    -0.98527764,  -0.17096189,
    -0.98630810,  -0.16491312,
    -0.98730142,  -0.15885814,
    -0.98825757,  -0.15279719,
    -0.98917651,  -0.14673047,
    -0.99005821,  -0.14065824,
    -0.99090264,  -0.13458071,
    -0.99170975,  -0.12849811,
    -0.99247953,  -0.12241068,
    -0.99321195,  -0.11631863,
    -0.99390697,  -0.11022221,
    -0.99456457,  -0.10412163,
    -0.99518473,  -0.09801714,
    -0.99576741,  -0.09190896,
    -0.99631261,  -0.08579731,
    -0.99682030,  -0.07968244,
    -0.99729046,  -0.07356456,
    -0.99772307,  -0.06744392,
    -0.99811811,  -0.06132074,
    -0.99847558,  -0.05519524,
    -0.99879546,  -0.04906767,
    -0.99907773,  -0.04293826,
    -0.99932238,  -0.03680722,
    -0.99952942,  -0.03067480,
    -0.99969882,  -0.02454123,
    -0.99983058,  -0.01840673,
    -0.99992470,  -0.01227154,
    -0.99998118,  -0.00613588,
};
#else
#warning "FFT twiddle factors not defined in lut_twd[]. Comment outUSE_FFT_TWD_LUT"
#endif
#endif

#if 0
//generate data for fft
void fft_init(int n, double *real, double *imag) {
    int i;

    for (i=0; i<n; i++) {
        real[i]= 	100+
                    100 * cos(2.0*M_PI * 1 * i / n) +
                    10 * cos(2.0*M_PI * 2 * i / n) +
                    1 * ((double) rand() / RAND_MAX  - 0.5);
        imag[i]=0;
    }
}
#endif

#ifndef USE_FFT_TWD_LUT
//calculate the look-up tables
//n=FFT_N but only half of the cycle (FFT_N/2) is calculated
void lut_cal(void) {
    int i;
    int n=FFT_N;

    for (i=0; i<n/2; i+=1) {
        //lut_cos[i]=cos(-2*M_PI/n*i);
        //lut_sin[i]=sin(-2*M_PI/n*i);
        lut_twd[2*i]=cos(-2*M_PI/n*i);
        lut_twd[2*i+1]=sin(-2*M_PI/n*i);
        //printf("%12.8f, %12.8f,\n\r", lut_twd[i+i], lut_twd[i+i+1]);	//only used to produce the fft twiddle factor look-up tables
    }
}
#endif


/**********************************************************/
/* fft.c                                                  */
/* (c) Douglas L. Jones                                   */
/* University of Illinois at Urbana-Champaign             */
/* January 19, 1992                                       */
/*                                                        */
/*   fft: in-place radix-2 DIT DFT of a complex input     */
/*                                                        */
/*   input:                                               */
/* n: length of FFT: must be a power of two               */
/* m: n = 2**m                                            */
/*   input/output                                         */
/* x: double array of length n with real part of data     */
/* y: double array of length n with imag part of data     */
/*                                                        */
/*   Permission to copy and use this program is granted   */
/*   under a Creative Commons "Attribution" license       */
/*   http://creativecommons.org/licenses/by/1.0/          */
/**********************************************************/
void fft_ditr2(/*int n, */int m, double *x, double *y)
//int n,m;
//double x[],y[];
{
    int n = 1ul<<m;
    int i,j,k,n1,n2;
    double c,s,/*e,a,*/t1,t2;
    int n_n1;					//n/n1


    j = 0; /* bit-reverse */
    n2 = n/2;
    for (i=1; i < n - 1; i++) {
        n1 = n2;
        while ( j >= n1 ) {
            j = j - n1;
            n1 = n1/2;
        }
        j = j + n1;

        if (i < j) {
            t1 = x[i];
            x[i] = x[j];
            x[j] = t1;
            t1 = y[i];
            y[i] = y[j];
            y[j] = t1;
        }
    }


    n1 = 0; /* FFT */
    n2 = 1;

    for (i=0; i < m; i++) {
        n1 = n2;
        n2 = n2 + n2;
        //e = -6.283185307179586/n2;
        //a = 0.0;

        for (j=0; j < n1; j++) {
            //printf("j=%5d, 2*m=%5d, n1=%5d, j*2*m/n1=%5d, a/2pi=%10.5f, sin=%10.5f, lut_sin=%10.5f\n\r", j, n/2, n1, j*n/2/n1, a/2/M_PI, sin(a), lut_twd[2*j*n/2/n1+1]);
            //c = cos(a);
            //s = sin(a);
            //a = a + e;
            //c = lut_cos[j*n/2/n1];
            //s = lut_sin[j*n/2/n1];
            n_n1 = n>>i;						//calculat stepping, to avoid n/n1 calculation
            c = lut_twd[j*n_n1];
            s = lut_twd[j*n_n1+1];


            for (k=j; k < n; k=k+n2) {
                t1 = c*x[k+n1] - s*y[k+n1];
                t2 = s*x[k+n1] + c*y[k+n1];
                x[k+n1] = x[k] - t1;
                y[k+n1] = y[k] - t2;
                x[k] = x[k] + t1;
                y[k] = y[k] + t2;
            }
        }
    }
}

/**********************************************************/
/* fft.c                                                  */
/* (c) Douglas L. Jones                                   */
/* University of Illinois at Urbana-Champaign             */
/* January 19, 1992                                       */
/*                                                        */
/*   fft: in-place radix-2 DIT DFT of a complex input     */
/*                                                        */
/*   input:                                               */
/* n: length of FFT: must be a power of two               */
/* m: n = 2**m                                            */
/*   input/output                                         */
/* x: double array of length n with real part of data     */
/* y: double array of length n with imag part of data     */
/*                                                        */
/*   Permission to copy and use this program is granted   */
/*   under a Creative Commons "Attribution" license       */
/*   http://creativecommons.org/licenses/by/1.0/          */
/**********************************************************/
void fft_ditr2dj(/*int n, */int m, double *x, double *y)
//int n,m;
//double x[],y[];
{
    int n = 1ul<<m;
    int i,j,k,n1,n2;
    double c,s,e,a,t1,t2;
    //int n_n1;					//n/n1


    j = 0; /* bit-reverse */
    n2 = n/2;
    for (i=1; i < n - 1; i++) {
        n1 = n2;
        while ( j >= n1 ) {
            j = j - n1;
            n1 = n1/2;
        }
        j = j + n1;

        if (i < j) {
            t1 = x[i];
            x[i] = x[j];
            x[j] = t1;
            t1 = y[i];
            y[i] = y[j];
            y[j] = t1;
        }
    }


    n1 = 0; /* FFT */
    n2 = 1;

    for (i=0; i < m; i++) {
        n1 = n2;
        n2 = n2 + n2;
        e = -2 * M_PI / n2;		//e = -6.283185307179586/n2;
        a = 0.0;

        for (j=0; j < n1; j++) {
            //printf("j=%5d, 2*m=%5d, n1=%5d, j*2*m/n1=%5d, a/2pi=%10.5f, sin=%10.5f, lut_sin=%10.5f\n\r", j, n/2, n1, j*n/2/n1, a/2/M_PI, sin(a), lut_twd[2*j*n/2/n1+1]);
            c = cos(a);
            s = sin(a);
            a = a + e;
            //c = lut_cos[j*n/2/n1];
            //s = lut_sin[j*n/2/n1];
            //n_n1 = n>>i;						//calculat stepping, to avoid n/n1 calculation
            //c = lut_twd[j*n_n1];
            //s = lut_twd[j*n_n1+1];


            for (k=j; k < n; k=k+n2) {
                t1 = c*x[k+n1] - s*y[k+n1];
                t2 = s*x[k+n1] + c*y[k+n1];
                x[k+n1] = x[k] - t1;
                y[k+n1] = y[k] - t2;
                x[k] = x[k] + t1;
                y[k] = y[k] + t2;
            }
        }
    }

    //return;
}

/*******************************************************************
函数原型：struct compx EE(struct compx b1,struct compx b2)
函数功能：对两个复数进行乘法运算
输入参数：两个以联合体定义的复数a,b
输出参数：a和b的乘积，以联合体的形式输出
*******************************************************************/
compx EE(compx a, compx b) {
    compx c;
    c.real=a.real*b.real-a.imag*b.imag;
    c.imag=a.real*b.imag+a.imag*b.real;
    return(c);
}

/*****************************************************************
函数原型：void FFT(struct compx *xin,int N)
函数功能：对输入的复数组进行快速傅里叶变换（FFT）
输入参数：*xin复数结构体组的首地址指针，struct型
*****************************************************************/
void fft_float(int n, compx *xin) {
    int f,m,nv2,nm1,i,k,l,j=0;
    compx u,w,t;
	int fft_n = 1ul << n;

    nv2=fft_n/2;                  //变址运算，即把自然顺序变成倒位序，采用雷德算法
    nm1=fft_n-1;
    for(i=0; i<nm1; i++) {
        if(i<j) {                  //如果i<j,即进行变址
            t=xin[j];
            xin[j]=xin[i];
            xin[i]=t;
        }
        k=nv2;                    //求j的下一个倒位序
        while(k<=j) {             //如果k<=j,表示j的最高位为1
            j=j-k;                 //把最高位变成0
            k=k/2;                 //k/2，比较次高位，依次类推，逐个比较，直到某个位为0
        }
        j=j+k;                   //把0改为1
    }

    {
        int le,lei,ip;                            //FFT运算核，使用蝶形运算完成FFT运算
        f=fft_n;
        for(l=1; (f=f/2)!=1; l++)                //计算l的值，即计算蝶形级数
            ;
        for(m=1; m<=l; m++) {                     // 控制蝶形结级数
            //m表示第m级蝶形，l为蝶形级总数l=log（2）N
            le=2<<(m-1);                            //le蝶形结距离，即第m级蝶形的蝶形结相距le点
            lei=le/2;                               //同一蝶形结中参加运算的两点的距离
            u.real=1.0;                             //u为蝶形结运算系数，初始值为1
            u.imag=0.0;
            w.real=cos(M_PI/lei);                     //w为系数商，即当前系数与前一个系数的商
            w.imag=-sin(M_PI/lei);
            for(j=0; j<=lei-1; j++) {               //控制计算不同种蝶形结，即计算系数不同的蝶形结
                for(i=j; i<=fft_n-1; i=i+le) {        //控制同一蝶形结运算，即计算系数相同蝶形结
                    ip=i+lei;                           //i，ip分别表示参加蝶形运算的两个节点
                    t=EE(xin[ip],u);                    //蝶形运算，详见公式
                    xin[ip].real=xin[i].real-t.real;
                    xin[ip].imag=xin[i].imag-t.imag;
                    xin[i].real=xin[i].real+t.real;
                    xin[i].imag=xin[i].imag+t.imag;
                }
                u=EE(u,w);                           //改变系数，进行下一个蝶形运算
            }
        }
    }

}

